{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Xling Configuration",
  "description": "Configuration file for xling CLI tool",
  "type": "object",
  "properties": {
    "providers": {
      "minItems": 1,
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "description": "Provider name (unique identifier)",
            "type": "string",
            "minLength": 1
          },
          "baseUrl": {
            "description": "API base URL",
            "type": "string",
            "format": "uri"
          },
          "apiKey": {
            "description": "Single API key (use apiKey or apiKeys, not both)",
            "type": "string"
          },
          "apiKeys": {
            "description": "Multiple API keys for rotation",
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "models": {
            "description": "List of supported models",
            "minItems": 1,
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "priority": {
            "description": "Provider priority (lower = higher priority)",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "timeout": {
            "description": "Request timeout in milliseconds",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "headers": {
            "description": "Custom headers to include in requests",
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {
              "type": "string"
            }
          },
          "weight": {
            "description": "Weight for weighted load balancing",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "enabled": {
            "description": "Enable or disable the provider without removing it",
            "default": true,
            "type": "boolean"
          }
        },
        "required": [
          "name",
          "baseUrl",
          "models"
        ],
        "additionalProperties": false
      }
    },
    "defaultModel": {
      "type": "string"
    },
    "loadBalance": {
      "description": "Global load balancing strategy (overridden by proxy.loadBalance when set)",
      "default": "failover",
      "type": "string",
      "enum": [
        "round-robin",
        "random",
        "weighted",
        "failover"
      ]
    },
    "noRetryErrors": {
      "description": "Error patterns or status codes that should not trigger retry/fallback",
      "default": [
        "401",
        "403",
        "invalid_api_key"
      ],
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "cooldownMs": {
      "description": "Global cooldown for failed providers in milliseconds (proxy.keyRotation.cooldownMs overrides)",
      "default": 60000,
      "type": "integer",
      "exclusiveMinimum": 0,
      "maximum": 9007199254740991
    },
    "proxy": {
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Enable proxy server",
          "default": true,
          "type": "boolean"
        },
        "port": {
          "description": "Proxy server port (default: 4320)",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "host": {
          "description": "Proxy server host (default: 127.0.0.1)",
          "type": "string"
        },
        "accessKey": {
          "description": "Access key for proxy authentication (optional)",
          "type": "string"
        },
        "loadBalance": {
          "description": "Load balancing strategy",
          "default": "failover",
          "type": "string",
          "enum": [
            "round-robin",
            "random",
            "weighted",
            "failover"
          ]
        },
        "modelMapping": {
          "description": "Map client model names to actual models (proxy only)",
          "type": "object",
          "propertyNames": {
            "type": "string"
          },
          "additionalProperties": {
            "type": "string"
          }
        },
        "passthroughResponsesAPI": {
          "description": "Models that natively support Responses API - skip conversion (e.g., gpt-5.1-codex-max)",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "keyRotation": {
          "description": "API key rotation settings",
          "type": "object",
          "properties": {
            "enabled": {
              "default": true,
              "type": "boolean"
            },
            "onError": {
              "default": true,
              "type": "boolean"
            },
            "cooldownMs": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 9007199254740991
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "retryPolicy": {
      "type": "object",
      "properties": {
        "maxRetries": {
          "description": "Maximum number of retries",
          "default": 2,
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "backoffMs": {
          "description": "Initial backoff delay in milliseconds",
          "default": 1000,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        }
      },
      "additionalProperties": false
    },
    "shortcuts": {
      "type": "object",
      "propertyNames": {
        "type": "string"
      },
      "additionalProperties": {
        "type": "object",
        "properties": {
          "command": {
            "type": "string",
            "minLength": 1
          },
          "args": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "shell": {
            "anyOf": [
              {
                "type": "string",
                "minLength": 1
              },
              {
                "type": "object",
                "properties": {
                  "win32": {
                    "type": "string",
                    "minLength": 1
                  },
                  "darwin": {
                    "type": "string",
                    "minLength": 1
                  },
                  "linux": {
                    "type": "string",
                    "minLength": 1
                  },
                  "default": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "required": [
                  "default"
                ],
                "additionalProperties": false
              }
            ]
          },
          "pipeline": {
            "anyOf": [
              {
                "minItems": 1,
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "command": {
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "object",
                          "properties": {
                            "win32": {
                              "type": "string",
                              "minLength": 1
                            },
                            "darwin": {
                              "type": "string",
                              "minLength": 1
                            },
                            "linux": {
                              "type": "string",
                              "minLength": 1
                            },
                            "default": {
                              "type": "string",
                              "minLength": 1
                            }
                          },
                          "required": [
                            "default"
                          ],
                          "additionalProperties": false
                        }
                      ]
                    },
                    "args": {
                      "anyOf": [
                        {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "win32": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            "darwin": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            "linux": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            "default": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            }
                          },
                          "required": [
                            "default"
                          ],
                          "additionalProperties": false
                        }
                      ]
                    }
                  },
                  "required": [
                    "command"
                  ],
                  "additionalProperties": false
                }
              },
              {
                "type": "object",
                "properties": {
                  "win32": {
                    "minItems": 1,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "command": {
                          "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "darwin": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "linux": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "default": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        },
                        "args": {
                          "anyOf": [
                            {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "darwin": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "linux": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "default": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "required": [
                        "command"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "darwin": {
                    "minItems": 1,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "command": {
                          "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "darwin": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "linux": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "default": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        },
                        "args": {
                          "anyOf": [
                            {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "darwin": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "linux": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "default": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "required": [
                        "command"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "linux": {
                    "minItems": 1,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "command": {
                          "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "darwin": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "linux": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "default": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        },
                        "args": {
                          "anyOf": [
                            {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "darwin": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "linux": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "default": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "required": [
                        "command"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "default": {
                    "minItems": 1,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "command": {
                          "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "darwin": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "linux": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "default": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        },
                        "args": {
                          "anyOf": [
                            {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            {
                              "type": "object",
                              "properties": {
                                "win32": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "darwin": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "linux": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "default": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              },
                              "required": [
                                "default"
                              ],
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "required": [
                        "command"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "default"
                ],
                "additionalProperties": false
              }
            ]
          },
          "description": {
            "type": "string"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "required": [
    "providers"
  ],
  "additionalProperties": false
}
